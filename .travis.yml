language: c++
matrix:
  fast_finish: true
  include:
    - os: osx
      env: TOOLSET=clang COMPILER=clang++

    - os: linux
      env: CMAKE=ON COMPILER=clang++-3.8
      addons:
        apt:
          packages:
          - clang-3.8
          - libstdc++-5-dev
          - gdb
          - bc
          sources:
          - ubuntu-toolchain-r-test
          - llvm-toolchain-precise



  # - os: osx
  #   env: CMAKE=ON COMPILER=clang++
  # - os: osx
  #   osx_image: xcode7
  #   env: TOOLSET=clang COMPILER=clang++
  # - os: osx
  #   osx_image: xcode7
  #   env: CMAKE=ON BENCHMARK=ON COMPILER=clang++

before_script:
- git config --global user.name "Travis-CI"
- git config --global user.email "travis@ci.net"
- git config --global push.default simple
- (cd build && ./bootstrap.sh)

#before_install:
#  - if [ "$TRAVIS_OS_NAME" == "osx" ]; then (brew install boost); fi
#  - if [ "$TRAVIS_OS_NAME" == "linux" ]; then (sudo apt-get install -qq boost); fi


install:
- export CXX="${COMPILER}"
- if [ "${LIBCXX}" != "" ]; then (svn --quiet co http://llvm.org/svn/llvm-project/libcxx/trunk libcxx
  && cd libcxx/lib && ./buildit && ln -f -s libc++.so.1.0 libc++.so.1)
  && export CXXFLAGS="-stdlib=libc++ -I${TRAVIS_BUILD_DIR}/libcxx/include"
  && export LDFLAGS="-L${TRAVIS_BUILD_DIR}/libcxx/lib -lc++"
  && export LD_LIBRARY_PATH="${TRAVIS_BUILD_DIR}/libcxx/lib:$LD_LIBRARY_PATH"; fi

script:
-        make
-        ./race

